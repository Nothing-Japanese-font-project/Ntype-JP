use flake

# previewサーバーをバックグラウンドで自動起動
_start_preview() {
  # 既に起動中かチェック
  if ! pgrep -f "serve_preview.py" > /dev/null; then
    echo "Starting preview server..."
    (cd "$PWD" && nohup uv run serve_preview.py > /tmp/ntype_preview.log 2>&1 &)
    sleep 2
    echo "Preview server started (check http://localhost:8080 or :8081)"
  else
    echo "Preview server already running"
  fi
}

# ディレクトリ進入時に自動起動
_start_preview
